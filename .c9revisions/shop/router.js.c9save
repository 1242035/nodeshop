{"ts":1369162942064,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"// Require routes\nvar account = require('./routes/account');\nvar main = require('./routes/main');\nvar product = require('./routes/product');\nvar cart = require('./routes/cart');\nvar category = require('./routes/category');\n\n// Function to only allow acess if authenticated\nfunction ensureAuthenticated(req, res, next) {\n  if (req.isAuthenticated()) { return next(); }\n  res.redirect('/login');\n}\n\n// Export routes\nmodule.exports = function(a, p) {\n\n  a.get('/', main.getHome);\n  a.get('/about', main.getAbout);\n  a.get('/contact', main.getContact);\n\n  a.get('/modals/register', account.getRegisterModal);\n  a.post('/register', account.postRegister);\n\n  a.get('/modals/login', account.getLoginModal);\n  a.get('/logout', account.getLogout);\n  \n  // Passport login function\n  a.post('/login', function(req, res, next) {p.authenticate('local', function(err, user, info) {if (err){return next(err);} if (!user) { return res.send({st:\"fail\"})} req.logIn(user, function(err) { if (err) { return next(err); } return res.redirect('/');});})(req, res, next);});\n  \n  a.get('/account', ensureAuthenticated, account.getAccount);\n  \n  a.get('/product/:seo', product.getBySEO);\n  \n  a.get('/category/:seo', category.getBySEO);\n  \n  a.post('/cart/add/:id', cart.addProduct);\n  \n};"]],"start1":0,"start2":0,"length1":0,"length2":1265}]],"length":1265}
{"contributors":[],"silentsave":false,"ts":1369163006436,"patch":[[{"diffs":[[0,"next) {\n"],[1,"  "],[0,"  if (re"]],"start1":312,"start2":312,"length1":16,"length2":18},{"diffs":[[0,"xt(); }\n"],[1,"    // Redirect if not authenticated\n  "],[0,"  res.re"]],"start1":362,"start2":362,"length1":16,"length2":55},{"diffs":[[0,", p) {\n\n"],[1,"  "],[0,"  a.get("]],"start1":482,"start2":482,"length1":16,"length2":18},{"diffs":[[0,"tHome);\n"],[1,"  "],[0,"  a.get("]],"start1":512,"start2":512,"length1":16,"length2":18},{"diffs":[[0,"About);\n"],[1,"  "],[0,"  a.get("]],"start1":548,"start2":548,"length1":16,"length2":18},{"diffs":[[0,"ntact);\n"],[-1,"\n"],[1,"    \n  "],[0,"  a.get("]],"start1":588,"start2":588,"length1":17,"length2":23},{"diffs":[[0,"dal);\n  "],[1," "],[1," "],[0,"a.post('"]],"start1":652,"start2":652,"length1":16,"length2":18},{"diffs":[[0,"ister);\n"],[1,"    "],[0,"\n"],[1,"  "],[0,"  a.get("]],"start1":697,"start2":697,"length1":17,"length2":23},{"diffs":[[0,"Modal);\n"],[1,"  "],[0,"  a.get("]],"start1":753,"start2":753,"length1":16,"length2":18},{"diffs":[[0,"out);\n  "],[1," "],[-1,"\n"],[1," \n  "],[0,"  // Pas"]],"start1":796,"start2":796,"length1":17,"length2":21},{"diffs":[[0,"unction\n"],[1,"  "],[0,"  a.post"]],"start1":830,"start2":830,"length1":16,"length2":18},{"diffs":[[0,"next);});\n  "],[-1,"\n"],[1,"  \n  "],[0,"  a.get('/ac"]],"start1":1111,"start2":1111,"length1":25,"length2":29},{"diffs":[[0,"Account);\n  "],[-1,"\n"],[1,"  \n  "],[0,"  a.get('/pr"]],"start1":1180,"start2":1180,"length1":25,"length2":29},{"diffs":[[0,"etBySEO);\n  "],[-1,"\n"],[1,"  \n  "],[0,"  a.get('/ca"]],"start1":1231,"start2":1231,"length1":25,"length2":29},{"diffs":[[0,"SEO);\n  "],[-1,"\n"],[1,"  \n  "],[0,"  a.post"]],"start1":1288,"start2":1288,"length1":17,"length2":21}]],"length":1350,"saved":false}
{"ts":1369163017251,"patch":[[{"diffs":[[0,".redirect('/"],[1,"account/"],[0,"login');\n}\n\n"]],"start1":414,"start2":414,"length1":24,"length2":32}]],"length":1358,"saved":false}
{"ts":1369163056143,"patch":[[{"diffs":[[0,".post('/"],[1,"account/"],[0,"register"]],"start1":671,"start2":671,"length1":16,"length2":24},{"diffs":[[0,"a.get('/"],[1,"account/"],[0,"logout',"]],"start1":781,"start2":781,"length1":16,"length2":24},{"diffs":[[0,".post('/"],[1,"account/"],[0,"login', "]],"start1":867,"start2":867,"length1":16,"length2":24}]],"length":1382,"saved":false}
{"ts":1369163442603,"patch":[[{"diffs":[[0,", p) {\n\n    "],[-1,""],[0,""],[1,"// Main routes\n    "],[0,"a.get('/', m"]],"start1":490,"start2":490,"length1":24,"length2":43},{"diffs":[[0,"tContact);\n    \n"],[1,"    // Modal routes\n"],[0,"    a.get('/moda"]],"start1":612,"start2":612,"length1":32,"length2":52},{"diffs":[[0,"  a."],[-1,"pos"],[1,"ge"],[0,"t('/"],[-1,"account/register', account.postRegister);\n    \n    a.get('/modals/login', account.getLoginModal"],[1,"modals/login', account.getLoginModal);\n    \n    // Account routes\n    a.get('/account', ensureAuthenticated, account.getAccount);\n    a.post('/account/register', account.postRegister"],[0,");\n "]],"start1":707,"start2":707,"length1":110,"length2":196},{"diffs":[[0,"    "],[-1,"a.get('/account', ensureAuthenticated, account.getAccount);\n    \n    a.get('/product/:seo', product.getBySEO);\n    \n    a.get('/category/:seo', category.getBySEO);\n    "],[1,"// Category\n    a.get('/category/:seo', category.getBySEO);\n    \n    // Product\n    a.get('/product/:seo', product.getBySEO);\n    \n    // Cart\n    a.post('/cart/add/:id', cart.addProduct);"],[0,"\n   "]],"start1":1283,"start2":1283,"length1":176,"length2":196},{"diffs":[[0,"  a.post('/cart/"],[-1,"add"],[1,"rem"],[0,"/:id', cart.addP"]],"start1":1478,"start2":1478,"length1":35,"length2":35},{"diffs":[[0,"/rem/:id', cart."],[-1,"add"],[1,"rem"],[0,"Product);\n  \n};"]],"start1":1493,"start2":1493,"length1":34,"length2":34}]],"length":1527,"saved":false}
{"contributors":[],"silentsave":false,"ts":1369170630100,"patch":[[{"diffs":[[0,"getLogout);\n"],[1,"    a.get('/account/registered', account.getRegistered)\n"],[0,"    \n    // "]],"start1":939,"start2":939,"length1":24,"length2":80}]],"length":1583,"saved":false}
{"ts":1369170807157,"patch":[[{"diffs":[[0,"/account"],[1,"/home"],[0,"', ensur"]],"start1":794,"start2":794,"length1":16,"length2":21}]],"length":1588,"saved":false}
{"contributors":[],"silentsave":false,"ts":1369171818726,"patch":[[{"diffs":[[0,"uct);\n  "],[1,"  \n    // Checkout\n    a.get('/checkout/cart' checkout.getCart)"],[0,"\n};"]],"start1":1577,"start2":1577,"length1":11,"length2":74}]],"length":1651,"saved":false}
{"ts":1369171822046,"patch":[[{"diffs":[[0,"etCart)\n"],[1,"    \n"],[0,"};"]],"start1":1641,"start2":1641,"length1":10,"length2":15}]],"length":1656,"saved":false}
{"ts":1369171838725,"patch":[[{"diffs":[[0,"egory');"],[1,"\nvar checkout = require('./routes/checkout');"],[0,"\n\n// Fun"]],"start1":214,"start2":214,"length1":16,"length2":61}]],"length":1701,"saved":false}
{"ts":1369172061087,"patch":[[{"diffs":[[0,"ut/cart'"],[1,","],[0," checkou"]],"start1":1667,"start2":1667,"length1":16,"length2":17}]],"length":1702,"saved":false}
{"ts":1369175638026,"patch":[[{"diffs":[[0,"etCart)\n"],[1,"    a.get('/checkout/guest', checkout.getGuest)\n"],[0,"    \n};"]],"start1":1687,"start2":1687,"length1":15,"length2":63}]],"length":1750,"saved":false}
{"ts":1369219563025,"patch":[[{"diffs":[[0,"tGuest)\n"],[1,"    a.post('/checkout/guest', checkout.postGuest)\n"],[0,"    \n};"]],"start1":1735,"start2":1735,"length1":15,"length2":65}]],"length":1800,"saved":false}
{"contributors":[],"silentsave":false,"ts":1369310709246,"patch":[[{"diffs":[[0,"oginModal);\n"],[1,"    a.get('/modals/terms', main.getTermsModal)\n"],[0,"    \n    // "]],"start1":789,"start2":789,"length1":24,"length2":71}]],"length":1847,"saved":false}
